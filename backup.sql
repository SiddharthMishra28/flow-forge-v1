-- H2 2.2.224;
;             
CREATE USER IF NOT EXISTS "SA" SALT '32be0b355ee38ebf' HASH 'daaebd262c925af3900364b286841b16d073624bb53b1d9789ccde3641152461' ADMIN;         
CREATE MEMORY TABLE "PUBLIC"."APPLICATIONS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "CREATED_AT" TIMESTAMP(6) NOT NULL,
    "GITLAB_PROJECT_ID" CHARACTER VARYING(255) NOT NULL,
    "PERSONAL_ACCESS_TOKEN" CHARACTER VARYING(255) NOT NULL,
    "UPDATED_AT" TIMESTAMP(6) NOT NULL
);           
ALTER TABLE "PUBLIC"."APPLICATIONS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_C" PRIMARY KEY("ID"); 
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.APPLICATIONS;            
CREATE MEMORY TABLE "PUBLIC"."FLOW_EXECUTIONS"(
    "ID" UUID NOT NULL,
    "CREATED_AT" TIMESTAMP(6) NOT NULL,
    "END_TIME" TIMESTAMP(6),
    "FLOW_ID" BIGINT NOT NULL,
    "GLOBAL_VARIABLES" JSON,
    "RUNTIME_VARIABLES" JSON,
    "START_TIME" TIMESTAMP(6),
    "STATUS" CHARACTER VARYING(255)
);         
ALTER TABLE "PUBLIC"."FLOW_EXECUTIONS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_55" PRIMARY KEY("ID");             
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.FLOW_EXECUTIONS;         
CREATE MEMORY TABLE "PUBLIC"."FLOW_STEPS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "APPLICATION_ID" BIGINT NOT NULL,
    "BRANCH" CHARACTER VARYING(255) NOT NULL,
    "CREATED_AT" TIMESTAMP(6) NOT NULL,
    "INITIAL_TEST_DATA" JSON,
    "SQUASH_STEP_IDS" JSON,
    "TEST_STAGE" CHARACTER VARYING(255) NOT NULL,
    "TEST_TAG" CHARACTER VARYING(255) NOT NULL,
    "UPDATED_AT" TIMESTAMP(6) NOT NULL
);               
ALTER TABLE "PUBLIC"."FLOW_STEPS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_7" PRIMARY KEY("ID");   
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.FLOW_STEPS;              
CREATE MEMORY TABLE "PUBLIC"."FLOWS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "CREATED_AT" TIMESTAMP(6) NOT NULL,
    "FLOW_STEP_IDS" JSON NOT NULL,
    "GLOBAL_VARIABLES" JSON,
    "SQUASH_TEST_CASE_ID" BIGINT NOT NULL,
    "UPDATED_AT" TIMESTAMP(6) NOT NULL
);            
ALTER TABLE "PUBLIC"."FLOWS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_3" PRIMARY KEY("ID");        
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.FLOWS;   
CREATE MEMORY TABLE "PUBLIC"."PIPELINE_EXECUTIONS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "CREATED_AT" TIMESTAMP(6) NOT NULL,
    "END_TIME" TIMESTAMP(6),
    "FLOW_EXECUTION_ID" UUID NOT NULL,
    "FLOW_ID" BIGINT NOT NULL,
    "FLOW_STEP_ID" BIGINT NOT NULL,
    "INITIAL_TEST_DATA" JSON,
    "PIPELINE_ID" BIGINT,
    "PIPELINE_URL" CHARACTER VARYING(255),
    "RUNTIME_TEST_DATA" JSON,
    "START_TIME" TIMESTAMP(6),
    "STATUS" CHARACTER VARYING(255)
);               
ALTER TABLE "PUBLIC"."PIPELINE_EXECUTIONS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_A6" PRIMARY KEY("ID");         
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.PIPELINE_EXECUTIONS;     
ALTER TABLE "PUBLIC"."PIPELINE_EXECUTIONS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_A" CHECK("STATUS" IN('RUNNING', 'PASSED', 'FAILED', 'CANCELLED')) NOCHECK;     
ALTER TABLE "PUBLIC"."FLOW_EXECUTIONS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_5" CHECK("STATUS" IN('RUNNING', 'PASSED', 'FAILED', 'CANCELLED')) NOCHECK;         
